```fortran  
subroutine dhseqr (  
job,  
compz,  
n,  
ilo,  
ihi,  
h,  
ldh,  
wr,  
wi,  
z,  
*                          ldz,  
work,  
lwork,  
info  
)  
```  
  
DHSEQR computes the eigenvalues of a Hessenberg matrix H  
and, optionally, the matrices T and Z from the Schur decomposition  
H = Z T Z**T, where T is an upper quasi-triangular matrix (the  
Schur form), and Z is the orthogonal matrix of Schur vectors.  
  
Optionally Z may be postmultiplied into an input orthogonal  
matrix Q so that this routine can give the Schur factorization  
of a matrix A which has been reduced to the Hessenberg form H  
by the orthogonal matrix Q:  A = Q*H*Q**T = (QZ)*T*(QZ)**T.  
  
## Parameters  
Job : Character*1 [in]  
> = 'E':  compute eigenvalues only;  
> = 'S':  compute eigenvalues and the Schur form T.  
  
Compz : Character*1 [in]  
> = 'N':  no Schur vectors are computed;  
> = 'I':  Z is initialized to the unit matrix and the matrix Z  
> of Schur vectors of H is returned;  
> = 'V':  Z must contain an orthogonal matrix Q on entry, and  
  
N : Integer [in]  
> The order of the matrix H.  N >= 0.  
  
Ilo : Integer [in]  
  
Ihi : Integer [in]  
> It is assumed that H is already upper triangular in rows  
> and columns 1:ILO-1 and IHI+1:N. ILO and IHI are normally  
> set by a previous call to DGEBAL, and then passed to ZGEHRD  
> when the matrix output by DGEBAL is reduced to Hessenberg  
> form. Otherwise ILO and IHI should be set to 1 and N  
> respectively.  If N > 0, then 1 <= ILO <= IHI <= N.  
> If N = 0, then ILO = 1 and IHI = 0.  
  
H : Double Precision Array, Dimension (ldh,n) [in,out]  
> On entry, the upper Hessenberg matrix H.  
> On exit, if INFO = 0 and JOB = 'S', then H contains the  
> upper quasi-triangular matrix T from the Schur decomposition  
> (the Schur form); 2-by-2 diagonal blocks (corresponding to  
> complex conjugate pairs of eigenvalues) are returned in  
> standard form, with H(i,i) = H(i+1,i+1) and  
> contents of H are unspecified on exit.  (The output value of  
> H when INFO > 0 is given under the description of INFO  
> below.)  
> Unlike earlier versions of DHSEQR, this subroutine may  
> explicitly H(i,j) = 0 for i > j and j = 1, 2, ... ILO-1  
> or j = IHI+1, IHI+2, ... N.  
  
Ldh : Integer [in]  
> The leading dimension of the array H. LDH >= max(1,N).  
  
Wr : Double Precision Array, Dimension (n) [out]  
  
Wi : Double Precision Array, Dimension (n) [out]  
> The real and imaginary parts, respectively, of the computed  
> eigenvalues. If two eigenvalues are computed as a complex  
> conjugate pair, they are stored in consecutive elements of  
> WR and WI, say the i-th and (i+1)th, with WI(i) > 0 and  
> WI(i+1) < 0. If JOB = 'S', the eigenvalues are stored in  
> the same order as on the diagonal of the Schur form returned  
> in H, with WR(i) = H(i,i) and, if H(i:i+1,i:i+1) is a 2-by-2  
> WI(i+1) = -WI(i).  
  
Z : Double Precision Array, Dimension (ldz,n) [in,out]  
> If COMPZ = 'N', Z is not referenced.  
> If COMPZ = 'I', on entry Z need not be set and on exit,  
> if INFO = 0, Z contains the orthogonal matrix Z of the Schur  
> vectors of H.  If COMPZ = 'V', on entry Z must contain an  
> N-by-N matrix Q, which is assumed to be equal to the unit  
> matrix except for the submatrix Z(ILO:IHI,ILO:IHI). On exit,  
> Normally Q is the orthogonal matrix generated by DORGHR  
> after the call to DGEHRD which formed the Hessenberg matrix  
> H. (The output value of Z when INFO > 0 is given under  
> the description of INFO below.)  
  
Ldz : Integer [in]  
> The leading dimension of the array Z.  if COMPZ = 'I' or  
> COMPZ = 'V', then LDZ >= MAX(1,N).  Otherwise, LDZ >= 1.  
  
Work : Double Precision Array, Dimension (lwork) [out]  
> On exit, if INFO = 0, WORK(1) returns an estimate of  
> the optimal value for LWORK.  
  
Lwork : Integer [in]  
> The dimension of the array WORK.  LWORK >= max(1,N)  
> is sufficient and delivers very good and sometimes  
> may be required for optimal performance.  A workspace  
> query is recommended to determine the optimal workspace  
> size.  
> If LWORK = -1, then DHSEQR does a workspace query.  
> In this case, DHSEQR checks the input parameters and  
> estimates the optimal workspace size for the given  
> values of N, ILO and IHI.  The estimate is returned  
> in WORK(1).  No error message related to LWORK is  
> issued by XERBLA.  Neither H nor Z are accessed.  
  
Info : Integer [out]  
> = 0:  successful exit  
> < 0:  if INFO = -i, the i-th argument had an illegal  
> value  
> > 0:  if INFO = i, DHSEQR failed to compute all of  
> the eigenvalues.  Elements 1:ilo-1 and i+1:n of WR  
> and WI contain those eigenvalues which have been  
> successfully computed.  (Failures are rare.)  
> If INFO > 0 and JOB = 'E', then on exit, the  
> remaining unconverged eigenvalues are the eigen-  
> values of the upper Hessenberg matrix rows and  
> columns ILO through INFO of the final, output  
> value of H.  
> If INFO > 0 and JOB   = 'S', then on exit  
> where U is an orthogonal matrix.  The final  
> value of H is upper Hessenberg and quasi-triangular  
> in rows and columns INFO+1 through IHI.  
> If INFO > 0 and COMPZ = 'V', then on exit  
> less of the value of JOB.)  
> If INFO > 0 and COMPZ = 'I', then on exit  
> (final value of Z)  = U  
> less of the value of JOB.)  
> If INFO > 0 and COMPZ = 'N', then Z is not  
> accessed.  
  
